{#
The base login Twig template

This template sets up the HTML skeleton for the login page and defines several
blocks that can be overridden by a specific layout. This template cannot be
directly used, instead, it is extended by a layout that implements the styling
and semantic choices

@package OpenEMR
@subpackage Login
@author Robert Down <robertdown@live.com
@copyright Copyright (c) 2023 Robert Down <robertdown@live.com>
@copyright Copyright (c) 2023 Providence Healthtech
@license https://github.com/openemr/openemr/blob/master/LICENSE GNU General Public License 3
#}
{% set srOnly = (showLabels == true) ? "" : "sr-only" %}
<!DOCTYPE html>
<html lang="en">
<head>
    {# Polyfill crypto.randomUUID for non-secure contexts (e.g. HTTP not localhost). Required by some scripts e.g. Google GSI. #}
    <script>
    (function() {
        var c = typeof crypto !== 'undefined' ? crypto : {};
        if (typeof c.randomUUID !== 'function') {
            c.randomUUID = function randomUUID() {
                var bytes = new Uint8Array(16);
                if (typeof c.getRandomValues === 'function') {
                    c.getRandomValues(bytes);
                } else {
                    for (var i = 0; i < 16; i++) bytes[i] = Math.floor(Math.random() * 256);
                }
                bytes[6] = (bytes[6] & 0x0f) | 0x40;
                bytes[8] = (bytes[8] & 0x3f) | 0x80;
                var h = function(b) { var x = b.toString(16); return x.length === 1 ? '0' + x : x; };
                return [h(bytes[0]),h(bytes[1]),h(bytes[2]),h(bytes[3]),'-',h(bytes[4]),h(bytes[5]),'-',h(bytes[6]),h(bytes[7]),'-',h(bytes[8]),h(bytes[9]),'-',h(bytes[10]),h(bytes[11]),h(bytes[12]),h(bytes[13]),h(bytes[14]),h(bytes[15])].join('');
            };
        }
        if (typeof crypto === 'undefined') {
            window.crypto = c;
        }
    })();
    </script>
    {% if displayGoogleSignin %}
        {% include "login/partials/html/google_signin.html.twig" %}
    {% endif %}

    <title>{% block title %}{{ title|text }} {{ "Login"|xlt }}{% endblock %}</title>
    {% block head %}{% endblock %}
    {{ setupHeader() }}

    {% include "login/partials/js/login_submit.js.twig" %}

    {% block css %}
    <style type="text/css">
        .band,
        .box,
        .vertical-band {
            background-color: var(--light);
        }
    </style>
    {% endblock %}
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const passInput = document.getElementById('clearPass');
            const toggle = document.getElementById('password-icon');
            toggle.addEventListener('click', function () {
                const isPassword = passInput.getAttribute('type') === 'password';
                passInput.setAttribute('type', isPassword ? 'text' : 'password');
                this.classList.toggle('fa-eye');
                this.classList.toggle('fa-eye-slash');
            });
        });
    </script>
</head>
<body>

{% block pre_content %}{% endblock %}

{% block content %}{% endblock %}

{% block post_content %}{% endblock %}

</body>

</html>
{% if displayGoogleSignin %}
    {# @todo Google signing should be its own module and injected in a better way #}
    {% include "login/partials/js/google_signin.js.twig" %}
{% endif %}
